<div class="container">
  <mat-card>
    <mat-stepper linear>
      <mat-step [stepControl]="orderForm">
        <form [formGroup]="orderForm">
          <ng-template matStepLabel>Bestelldetails</ng-template>
          <mat-form-field appearance="fill">
            <mat-label>Name des Bestellers</mat-label>
            <input matInput formControlName="name" required />
            <mat-error *ngIf="orderForm.controls['name'].hasError('required')">
              Name des Bestellers ist erforderlich
            </mat-error>
          </mat-form-field>
          <mat-form-field appearance="fill">
            <mat-label>Bestellung</mat-label>
            <textarea
              matInput
              formControlName="order"
              required
              maxlength="100"
            ></textarea>
            <mat-error *ngIf="orderForm.controls['order'].hasError('required')">
              Bestellung ist erforderlich
            </mat-error>
            <mat-hint align="end">Maximal 100 Zeichen</mat-hint>
          </mat-form-field>
          <mat-form-field appearance="fill">
            <mat-label>Restaurant wählen</mat-label>
            <mat-select formControlName="restaurant" required>
              <mat-option
                *ngFor="let restaurant of restaurants"
                [value]="restaurant"
              >
                {{ restaurant }}
              </mat-option>
            </mat-select>
            <mat-error
              *ngIf="orderForm.controls['restaurant'].hasError('required')"
            >
              Restaurant ist erforderlich
            </mat-error>
          </mat-form-field>
          <mat-form-field appearance="fill">
            <mat-label>Preis</mat-label>
            <input matInput type="number" formControlName="price" />
            <mat-error *ngIf="orderForm.controls['price'].hasError('required')">
              Preis ist erforderlich
            </mat-error>
            <mat-error *ngIf="orderForm.controls['price'].hasError('min')">
              Preis muss größer als 0 sein
            </mat-error>
          </mat-form-field>
          <div>
            Möchten Sie Ihre Bestellung bezahlen?
            <span style="color: red">*</span>
          </div>
          <mat-radio-group formControlName="paid" required>
            <mat-radio-button value="yes">Ja</mat-radio-button>
            <mat-radio-button value="no">Nein</mat-radio-button>
          </mat-radio-group>
          <mat-error
            *ngIf="
              orderForm.controls['paid'].hasError('required') &&
              orderForm.controls['paid'].touched
            "
          >
            Bitte wählen Sie eine Option
          </mat-error>

          <div>Begleiten Sie den Einkäufer?</div>
          <mat-radio-group formControlName="accompany">
            <mat-radio-button value="yes">Ja</mat-radio-button>
            <mat-radio-button value="no">Nein</mat-radio-button>
          </mat-radio-group>

          <div class="actions">
            <button mat-raised-button routerLink="/">
              <mat-icon>arrow_back</mat-icon>Zurück
            </button>
            <button mat-raised-button matStepperNext (click)="checkPaidField()">
              Weiter
              <mat-icon>arrow_forward</mat-icon>
            </button>
          </div>
        </form>
      </mat-step>
      <mat-step>
        <ng-template matStepLabel>Überprüfung</ng-template>
        <p>Bestellübersicht:</p>
        <p>Name: {{ orderForm.controls["name"].value }}</p>
        <p>Bestellung: {{ orderForm.controls["order"].value }}</p>
        <p>Restaurant: {{ orderForm.controls["restaurant"].value }}</p>
        <p>Preis: {{ orderForm.controls["price"].value }}</p>
        <p>wird bezahlt: {{ orderForm.controls["paid"].value }}</p>
        <p>Begleiten: {{ orderForm.controls["accompany"].value }}</p>
        <a
          [href]="paypalLink"
          target="_blank"
          *ngIf="orderForm.controls['paid'].value === 'yes'"
          >Mit PayPal bezahlen</a
        >
        <div class="actions">
          <button mat-raised-button matStepperPrevious>
            <mat-icon>arrow_back</mat-icon>Zurück
          </button>
          <button mat-raised-button (click)="submitOrder()" matStepperNext>
            <mat-icon>check</mat-icon>
            Bestätigen
          </button>
        </div>
      </mat-step>
      <mat-step>
        <ng-template matStepLabel>Bestellung abgeschlossen</ng-template>
        <p>Ihre Bestellung wurde erfolgreich aufgegeben.</p>
        <button mat-raised-button routerLink="/">
          <mat-icon>home</mat-icon>Zur Startseite
        </button>
      </mat-step>
    </mat-stepper>
  </mat-card>
</div>
